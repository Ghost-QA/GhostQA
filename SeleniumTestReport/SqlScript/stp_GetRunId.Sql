CREATE OR ALTER PROCEDURE [dbo].[stp_GetRunId]
AS
BEGIN TRY
	DECLARE @Count INT = 0
	IF OBJECT_ID('tbl_TestCase', 'U') IS NOT NULL
	BEGIN
		IF EXISTS(SELECT 1 FROM tbl_TestCase)
		BEGIN
			SELECT @Count = MAX(CAST(Replace(RunId,'TestRun-','') AS INT)) FROM tbl_TestCase
		END
		ELSE
		BEGIN
			SET @Count = @Count + 1;
		END
	END
	SELECT CONCAT('TestRun-',CAST((@Count + 1) AS VARCHAR(20))) [RunId]
END TRY
BEGIN CATCH
	SELECT CONCAT('TestRun-',CAST(ERROR_MESSAGE() AS VARCHAR(20))) [RunId]
END CATCH